<ng-container *ngIf="editing === null">
  <!-- Responsible Parties View -->
  <section class="file-section">
    <h3>Allegedly Responsible Parties</h3>

    <!-- Crown Party (if property is Crown) -->
    <div *ngIf="isPropertyCrown" class="party-card">
      <div class="party-header">
        <h4>Crown</h4>
        <div class="party-type-badge">Crown</div>
      </div>
      
      <div class="party-details">
        <div class="field">
          <div class="field-heading">Notes</div>
          <app-inline-text
            [value]="crownNotes"
            placeholder="Add notes..."
            (save)="saveInlineEdit(crownParty, 'notes', $event)"
          ></app-inline-text>
        </div>
      </div>
    </div>

    <!-- Regular Responsible Parties -->
    <div *ngFor="let party of responsibleParties" 
         class="party-card" 
         [class.previous-party]="party.isPrevious">
      
      <div class="party-header">
        <h4>{{ getPartyDisplayName(party) }}</h4>
        <div class="party-type-badge" [class.previous]="party.isPrevious">
          {{ getPartyTypeDisplay(party) }}
        </div>
      </div>

      <div class="party-details">
        <!-- Address (if individual) -->
        <div *ngIf="party.foippaCategory === FOIPPACategory.INDIVIDUAL && getPartyAddress(party)" class="field">
          <div class="field-heading">Mailing Address</div>
          <div>{{ getPartyAddress(party) }}</div>
        </div>

        <!-- Email -->
        <div class="field">
          <div class="field-heading">Email</div>
          <app-inline-text
            [value]="getPartyEmail(party)"
            [isEmail]="true"
            placeholder="Add email..."
            (save)="saveInlineEdit(party, 'email', $event)"
          ></app-inline-text>
        </div>

        <!-- Telephone -->
        <div class="field">
          <div class="field-heading">Telephone</div>
          <app-inline-text
            [value]="getPartyPhone(party)"
            [mask]="'(000) 000-0000'"
            placeholder="Add telephone..."
            (save)="saveInlineEdit(party, 'phone', $event)"
          ></app-inline-text>
        </div>

        <!-- Directors (if organization) -->
        <div *ngIf="party.foippaCategory === FOIPPACategory.ORGANIZATION && party.directors?.length" class="directors-section">
          <div class="field-heading">Directors</div>
          <div *ngFor="let director of party.directors" class="director-item">
            <div class="director-name">{{ director.directorName }}</div>
            <div class="director-details">
              <div *ngIf="director.directorMailingAddress">{{ director.directorMailingAddress }}</div>
              <div *ngIf="director.directorEmail">
                <a [href]="'mailto:' + director.directorEmail">{{ director.directorEmail }}</a>
              </div>
              <div *ngIf="director.directorTelephone">{{ director.directorTelephone | mask: "(000) 000-0000" }}</div>
            </div>
          </div>
        </div>

        <!-- Notes -->
        <div class="field">
          <div class="field-heading">Notes</div>
          <app-inline-text
            [value]="getPartyNotes(party)"
            placeholder="Add notes..."
            (save)="saveInlineEdit(party, 'notes', $event)"
          ></app-inline-text>
        </div>
      </div>
    </div>

    <div class="edit-section-button-container">
      <a mat-flat-button color="accent" [routerLink]="'edit'" class="edit-section-button">Edit Section</a>
    </div>
  </section>

  <!-- Property Ownership Documents -->
  <section class="file-section">
    <app-compliance-and-enforcement-documents
      #ownershipDocumentsComponent
      [title]="'Property Ownership Documents'"
      [noDocumentsText]="'No ownership documents'"
      [fileNumber]="fileNumber"
      [options]="ownershipDocumentOptions"
      [section]="Section.OWNERSHIP"
      [addButtonText]="'+ Add Documents'"
    />
  </section>
</ng-container>

<ng-container *ngIf="editing === 'parties'">
  <form [formGroup]="form">
    <section class="form-section">
      <h3>Responsible Parties > Edit Allegedly Responsible Parties</h3>
      <app-compliance-and-enforcement-responsible-parties
        #responsiblePartiesComponent
        [fileUuid]="file?.uuid"
        [isPropertyCrown]="isPropertyCrown"
      />
    </section>

    <div class="button-container">
      <a mat-stroked-button color="warn" [routerLink]="['..']">Cancel</a>
      <button mat-flat-button color="primary" (click)="saveResponsibleParties()">Save</button>
    </div>
  </form>
</ng-container>

<ng-template #noData>
  <div class="no-data">No Data</div>
</ng-template>
