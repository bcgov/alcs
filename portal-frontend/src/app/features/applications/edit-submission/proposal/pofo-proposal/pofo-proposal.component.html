<div class="step-description">
  <h2>Proposal</h2>
  <p>All fields are required unless stated optional or disabled.</p>
  <app-commission-purposes-panel></app-commission-purposes-panel>
</div>
<app-warning-banner>
  In order to complete this step, please consult the following pages on the ALC website:
  <ul class="steps-list">
    <li>
      <a
        href="https://www.alc.gov.bc.ca/application-and-notice-process/applications/what-the-commission-considers/"
        target="_blank"
      >
        What the Commission Considers
      </a>
    </li>
    <li>
      <a
        href="https://www.alc.gov.bc.ca/application-and-notice-process/applications/required-documents/#pfrs"
        target="_blank"
        >Placement of Fill</a
      >
    </li>
  </ul>
</app-warning-banner>
<form [formGroup]="form">
  <div class="form-row">
    <div class="full-row">
      <mat-label for="noi-follow-up">
        Has the ALC previously received an application or Notice of Intent for this proposal?
      </mat-label>
      <div class="subtext">If yes, provide the ALC Application or Notice of Intent ID in the field below</div>
      <div>
        <mat-button-toggle-group
          class="input"
          (valueChange)="onChangeFollowUp($event)"
          id="noi-follow-up"
          [formControl]="isFollowUp"
        >
          <mat-button-toggle
            class="toggle-button"
            [ngClass]="{
              'error-outline': isFollowUp.invalid && (isFollowUp.dirty || isFollowUp.touched)
            }"
            value="true"
            >Yes
          </mat-button-toggle>
          <mat-button-toggle
            class="toggle-button"
            [ngClass]="{
              'error-outline': isFollowUp.invalid && (isFollowUp.dirty || isFollowUp.touched)
            }"
            value="false"
            >No
          </mat-button-toggle>
        </mat-button-toggle-group>
      </div>
    </div>
    <div class="full-row">
      <label for="followUpIDs">Application or NOI IDs</label>
      <div class="subtext">If you have multiple IDs, please separate with a comma.</div>
      <mat-form-field appearance="outline">
        <input type="text" [formControl]="followUpIDs" id="followUpIDs" matInput />
      </mat-form-field>
      <div *ngIf="followUpIDs.invalid && (followUpIDs.dirty || followUpIDs.touched)" class="field-error">
        <mat-icon>warning</mat-icon>
        <div *ngIf="followUpIDs.errors?.['required']">This field is required</div>
      </div>
    </div>
    <div class="full-row">
      <label for="purpose">What is the purpose of the proposal?</label>
      <div class="subtext">
        Include why you are applying for placement of fill, what the proposal will achieve, and any benefits to
        agriculture that the proposal provides.
      </div>
      <mat-form-field appearance="outline">
        <textarea
          formControlName="purpose"
          #purposeText
          maxlength="4000"
          id="purpose"
          matInput
          placeholder="Type comment"
        ></textarea>
      </mat-form-field>
      <div *ngIf="purpose.invalid && (purpose.dirty || purpose.touched)" class="field-error">
        <mat-icon>warning</mat-icon>
        <div *ngIf="purpose.errors?.['required']">This field is required</div>
      </div>
      <div class="subtext">Characters left: {{ 4000 - purposeText.textLength }}</div>
    </div>

    <div class="full-row">
      <label for="projectDuration">Placement of Fill Project Duration</label>
      <div class="subtext">Length of time you anticipate it would take to complete the project</div>
      <mat-form-field appearance="outline">
        <input id="projectDuration" matInput formControlName="projectDuration" placeholder="Type project duration" />
      </mat-form-field>
      <div *ngIf="projectDuration.invalid && (projectDuration.dirty || projectDuration.touched)" class="field-error">
        <mat-icon>warning</mat-icon>
        <div *ngIf="projectDuration.errors?.['required']">This field is required</div>
      </div>
      <mat-hint class="subtext">Example: 30 years; or 3 months; or 5 days</mat-hint>
    </div>

    <div class="full-row">
      <mat-label>Proposal Dimensions</mat-label>
      <div class="subtext">
        Please provide accurate numbers that align with your cross sections, reclamation plan, and site plan. The
        Commission will consider your proposal dimensions when determining the potential impact it will have on the
        agricultural capability of the land.
      </div>
      <app-info-banner>
        Please refer to
        <a
          href="https://www.alc.gov.bc.ca/application-and-notice-process/applications/required-documents/#pfrs"
          target="_blank"
          >Placement of Fill</a
        >
        on the ALC website for more detail.
      </app-info-banner>
      <app-soil-table
        tableHeader="Fill to be Placed"
        [(data)]="fillTableData"
        (dataChange)="markDirty()"
      ></app-soil-table>
    </div>
    <div class="full-row">
      <mat-label
        >Of the proposed totals provided above, please input the dimensions of fill that has already been
        place.</mat-label
      >
      <app-soil-table
        tableHeader="Fill already Placed"
        [(data)]="alreadyFilledTableData"
        (dataChange)="markDirty()"
      ></app-soil-table>
    </div>

    <div class="full-row">
      <label for="fillTypeToPlace">Describe the type, origin and quality of fill proposed to be placed.</label>
      <div class="subtext">
        List all proposed types of fill. Prohibited fill cannot be placed within the Agricultural Land Reserve.
      </div>
      <mat-form-field appearance="outline">
        <textarea
          formControlName="fillTypeToPlace"
          #fillTypeToPlaceText
          maxlength="4000"
          id="fillTypeToPlace"
          matInput
          placeholder="Type comment"
        ></textarea>
      </mat-form-field>
      <div *ngIf="fillTypeToPlace.invalid && (fillTypeToPlace.dirty || fillTypeToPlace.touched)" class="field-error">
        <mat-icon>warning</mat-icon>
        <div *ngIf="fillTypeToPlace.errors?.['required']">This field is required</div>
      </div>
      <mat-hint class="subtext">Example: Aggregate, topsoil, structural fill, sand, gravel, etc</mat-hint>
      <span class="subtext">Characters left: {{ 4000 - fillTypeToPlaceText.textLength }}</span>
    </div>
    <div class="full-row">
      <label for="alternativeMeasures">
        What alternative measures have you considered or attempted before proposing to place fill?
        <div class="subtext">
          Applicants should provide evidence demonstrating that normal farm practices have been attempted prior to the
          submission of this application to place fill.
        </div>
      </label>
      <mat-form-field appearance="outline">
        <textarea
          [formControl]="alternativeMeasures"
          #alternativeMeasuresText
          maxlength="4000"
          id="alternativeMeasures"
          matInput
          placeholder="Type comment"
        ></textarea>
      </mat-form-field>
      <div
        *ngIf="reduceNegativeImpacts.invalid && (reduceNegativeImpacts.dirty || reduceNegativeImpacts.touched)"
        class="field-error"
      >
        <mat-icon>warning</mat-icon>
        <div *ngIf="reduceNegativeImpacts.errors?.['required']">This field is required</div>
      </div>
      <mat-hint class="subtext">
        Example: Project phasing, providing landscape screening, fencing, buffering, erosion and sediment control,
        temporary or permanent drainage, etc.
      </mat-hint>
      <div class="subtext">Characters left: {{ 4000 - alternativeMeasuresText.textLength }}</div>
    </div>
    <div class="full-row">
      <label for="agricultural-support">
        What steps will be taken to reduce impacts to surrounding agricultural land?
        <div class="subtext">Describe impact reducing measures.</div>
      </label>
      <mat-form-field appearance="outline">
        <textarea
          [formControl]="reduceNegativeImpacts"
          #reduceNegativeImpactsText
          maxlength="4000"
          id="agricultural-support"
          matInput
          placeholder="Type comment"
        ></textarea>
      </mat-form-field>
      <div
        *ngIf="reduceNegativeImpacts.invalid && (reduceNegativeImpacts.dirty || reduceNegativeImpacts.touched)"
        class="field-error"
      >
        <mat-icon>warning</mat-icon>
        <div *ngIf="reduceNegativeImpacts.errors?.['required']">This field is required</div>
      </div>
      <mat-hint class="subtext">
        Example: Project phasing, providing landscape screening, fencing, buffering, erosion and sediment control,
        temporary or permanent drainage, etc.
      </mat-hint>
      <div class="subtext">Characters left: {{ 4000 - reduceNegativeImpactsText.textLength }}</div>
    </div>
    <div class="full-row">
      <mat-label class="subheading2" for="proposal-map">Proposal Map / Site Plan</mat-label>
      <div class="subtext">A visual representation of your proposal.</div>
      <app-file-drag-drop
        id="proposal-map"
        [uploadedFiles]="proposalMap"
        (uploadFiles)="attachProposalMap($event)"
        (deleteFile)="onDeleteFile($event)"
        (openFile)="openFile($event)"
        [showErrors]="showErrors"
        [isRequired]="true"
        [showVirusError]="showProposalMapVirus"
      ></app-file-drag-drop>
    </div>
    <div class="full-row">
      <mat-label class="subheading2" for="cross-section">Cross Sections</mat-label>
      <div class="subtext">Include North-South and East-West cross sections</div>
      <app-info-banner>
        Please refer to
        <a
          href="https://www.alc.gov.bc.ca/application-and-notice-process/applications/required-documents/#pfrs"
          target="_blank"
          >Placement of Fill</a
        >
        on the ALC website for more information
      </app-info-banner>
      <app-file-drag-drop
        id="cross-section"
        [uploadedFiles]="crossSections"
        (uploadFiles)="attachCrossSection($event)"
        (deleteFile)="onDeleteFile($event)"
        (openFile)="openFile($event)"
        [showErrors]="showErrors"
        [isRequired]="true"
        [allowMultiple]="true"
        [showVirusError]="showCrossSectionVirus"
      ></app-file-drag-drop>
    </div>
    <div class="full-row">
      <mat-label class="subheading2" for="reclamation-plan">Reclamation Plan</mat-label>
      <div class="subtext">
        The Reclamation Plan should be completed by a qualified Professional Agrologist and contain the area's
        agricultural capability assessment.
      </div>
      <app-info-banner>
        Please refer to
        <a
          href="https://www.alc.gov.bc.ca/application-and-notice-process/applications/required-documents/#pfrs"
          target="_blank"
          >Placement of Fill</a
        >
        on the ALC website for more information
      </app-info-banner>
      <app-file-drag-drop
        id="reclamation-plan"
        [uploadedFiles]="reclamationPlan"
        (uploadFiles)="attachReclamationPlan($event)"
        (deleteFile)="onDeleteFile($event)"
        (openFile)="openFile($event)"
        [showErrors]="showErrors"
        [isRequired]="true"
        [allowMultiple]="true"
        [showVirusError]="showReclamationPlanVirus"
      ></app-file-drag-drop>
    </div>
  </div>
</form>
<app-button-container [draftMode]="draftMode" [currentStep]="currentStep" (saveExit)="onSaveExit()"
(navigateStep)="onNavigateToStep($event)"></app-button-container>
